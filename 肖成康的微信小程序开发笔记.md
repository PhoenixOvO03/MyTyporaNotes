# 肖成康的微信小程序开发笔记

## 目标

1. 能够知道如何创建小程序项目
2. 能够清楚小程序项目的基本组成结构
3. 能够知道小程序页面由几部分组成
4. 能够知道小程序中常见的组件如何使用
5. 能够知道小程序如何进行协同开发和发布

## 小程序开发准备

+ 注册小程序开发账号
  1. 打开https://mp.weixin.qq.com网址
  2. 点击右上角立即注册
  3. 选择注册账号类型：小程序
  4. 根据提示填写信息
+ 获取小程序AppID
  1. 进入小程序管理后台
  2. 选择开发，开发管理，开发设置
+ 安装开发者工具
  1. 网址：https://developers.weixin.qq.com/miniprogram/dev/devtools/stable.html
  2. 选择稳定版，根据自己电脑型号下载
  3. 打开下载好的安装程序进行安装
+ 开发者工具设置
  1. 点击右上角设置
  2. 将代理设置为不使用任何代理，勾选后直连网络
  3. 字号建议18，行距建议12

## 第一个小程序

### 创建小程序项目

1. 点击加号，开始新建项目
2. 编辑项目名字，选择存储路径，复制AppID，后端服务选择不使用云服务，点击确定
3. 帮助，开发者文档，里面有许多参考资料
4. 模拟器机型建议iPhone 6/7/8

### 小程序代码构成

+ ==pages==：用于存放所有小程序的页面
+ utils：用于存放工具性质的模块
+ ==app.js==：小程序项目的入口文件
+ ==app.json==：小程序项目的全局配置文件
+ app.wxss：小程序项目的全局样式文件
+ project.config.json：项目的配置文件
+ sitemap.json：用来配置小程序及其页面是否允许被微信索引

### 小程序页面的组成部分

所有的小程序页面存放在==pages目录==，以==单独的文件夹==存在，每个页面由==4个基本文件==组成

+ .js：页面的脚本文件，存放页面的数据、事件处理函数等
+ .json：当前页面的配置文件，配置窗口的外观、表现等
+ .wxml：页面的模板结构文件
+ .wxss：当前页面的样式表文件

#### JS逻辑交互

在小程序中，通过.js文件处理用户的操作，如获取用户的位置、响应用户的点击，小程序.js文件分为三类

+ app.js

  是**整个小程序项目的入口文件**，通过调用==App()==函数来启动整个小程序

+ 页面的js.文件

  是**页面的入口文件**。通过调用==Page()==函数来创建并运行页面

+ 普通的js.文件

  是**普通的功能模块文件**，用于封装**公共函数或属性**供页面使用

#### JSON配置文件

json是一种==数据格式==，在实际开发总是以==配置文件==的形式出现，小程序中通过不同的.json配置文件，可以对小程序进行不同级别的配置，小程序项目里有4种.json配置文件

+ 项目根目录中的==app.json==配置文件

  app.json是当前小程序的**全局配置**，包括了小程序的所有**页面路径、窗口外观、界面表现、底部tab**等，app.json配置文件含有4个配置项

  1. pages：用来记录当前小程序所有的页面路径
  2. window：全局定义小程序所有页面的背景色、文字颜色等
  3. style：全局定义小程序组件所使用的样式版本
  4. sitemapLacation：用来指明sitemap.json的位置

+ 项目根目录中的==project.config.json==配置文件

  project.config.json是项目配置文件，用来记录我们对**小程序开发工具所做的个性化配置**

  1. setting：保存了编译相关的配置
  2. projectname：保存项目名称
  3. appid：保存小程序的账号ID

+ 项目根目录中的sitemap.json配置文件

  sitemap.json文件用来**配置小程序页面是否允许微信索引**

+ ==每个页面文件中的.json配置文件==

  小程序每一个页面，可以使用.json文件来**对本页面的窗口外观进行配置，页面中的配置项会覆盖app.json的Window中相同的配置项**

#### WXML模板

WXML是小程序框架设计的一套**标签语言，用来构建小程序页面结构**，作用类似于网页开发中的HTML

#### WXSS样式

WXSS是小程序的一套样式语言，用与描述WXML的组件样式，类似于网页开发中的CSS

### 新建小程序页面[^1]

1. 打开app.json
2. 在pages内的末尾加上逗号，回车
3. 输入"pages/文件名/页面名"
4. Ctrl+s保存
5. pages中第一个默认为小程序首页

### 宿主环境

宿主环境是程序运行必须的依赖环境，脱离宿主环境的软件是没有任何意义的，Android和iOS是两种不同的宿主环境，微信就是小程序的宿主环境，小程序宿主环境包含四方面内容

#### 通信模型

小程序通信的主体是渲染层和逻辑层，WXML和WXSS工作在渲染层，JS脚本工作在逻辑层，小程序的通信模型分为两部分

+ 渲染层和逻辑层之间的通讯
+ 逻辑层和第三方服务器之间的通信

#### 运行机制

+ 下载小程序代码包到本地
+ 解析app.json全局配置文件
+ 执行app.js小程序入口文件，**调用App()创建小程序实例**
+ 渲染小程序首页
  1. 加载解析页面的.json配置文件
  2. 加载页面的.wxml模板和.wxss样式
  3. 执行页面的.js文件，**调用Page()创建页面实例**
  4. 页面渲染完成
+ 小程序启动成功

#### 组件

**小程序的组件是由宿主环境提供的**，开发者可以基于组件快速搭建出页面结构，官方把小程序的组件分为9类

1. **视图容器**

   * view

     普通的视图区域，类似于HTML中的div，是一个块级元素，常用来实线页面的布局效果

   * scroll-view

     可滚动的视图区域，常用来实现滚动列表效果

   * swiper和swiper-item

     轮播图容器组件和轮播图item组件

   在小程序页面添加块区域

   1. 打开需要添加块区域的页面的文件夹

   2. 打开.wxml文件

   3. 需要添加块区域的位置写下

      \<view class="xxx">\</view>

   4. 在.wxss文件中编辑块区域格式

      .xxx{}

2. **基础内容**

3. **表单组件**

4. **导航组件**

5. 媒体组件

6. map地图组件

7. canvas画布组件

8. 开放能力

9. 无障碍访问

#### API



看到P8

[^1]:新建小程序页面





